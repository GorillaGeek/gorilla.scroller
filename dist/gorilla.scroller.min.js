window.gorilla||(window.gorilla={}),function(e,t){function i(){var t=c.find("> section");t.each(function(i){d.add(e(this),i,t.length)}),d[0].active(!0)}function n(){var t,i,n=null;e(window).mousewheel(function(){return clearTimeout(t),i=d.current(),null===n&&(n=i.elem.scrollTop()),event.deltaY>0?void(t=setTimeout(function(){i.hasScroll()&&n!==i.elem.scrollTop()||l(),n=null},u.scrollDelay)):void(t=setTimeout(function(){i.hasScroll()&&n!==i.elem.scrollTop()||r(),n=null},u.scrollDelay))})}function l(){var e=d.current();e.isScrollOnBottom()&&e.next()&&e.active(!1)}function r(){var e=d.current();e.isScrollOnTop()&&e.prev()&&e.prev().active(!0)}function o(){a=e("<nav class='gorilla-scroller-navigation' />");var t=e("<ul />");d.forEach(function(i){var n=e("<li />"),l=e("<a />");l.attr({section:i.index}),n.append(l),t.append(n)}),a.css({"z-index":d.length+u.zIndex}),a.append(t),c.append(a),a.on("click","a",function(){d.find(e(this).attr("section")).active(!0)}),setTimeout(function(){a.height(t.height()),s()},0)}function s(){if(a){var e=d.current();a.find("li").removeClass("active"),a.find("[section="+e.index+"]").parents("li").addClass("active")}}var c,a,u={zIndex:0,scrollDelay:300};t.scroller=function(t,i){this.init(e(t),i||{})},e.fn.gorillaScroller=function(e){return new t.scroller(this,e)};var d=[];d.add=function(e,t,i){d.push(new h(e,t,i-t+u.zIndex))},d.current=function(){return d.filter(function(e){return e.is(c.find(".gorilla-scroller-active").first())})[0]},d.find=function(e){var t=c.find("#gorilla-scroller-section-"+e);return t.size()?d.filter(function(e){return e.is(t)})[0]:null},t.scroller.prototype.init=function(t,l){c=t,e.extend(u,l),e("body").addClass("gorilla-scroller"),c.addClass("gorilla-scroller-root"),i(),n(),o(c)};var h=function(e,t,i){this.elem=e,this.index=t,e.addClass("gorilla-scroller-section gorilla-scroller-section-"+t),e.attr("id","gorilla-scroller-section-"+t),e.css({"z-index":i})};h.prototype.is=function(t){return this.elem[0]===e(t)[0]},h.prototype.hasScroll=function(){return this.elem[0].scrollHeight-this.elem.height()>0},h.prototype.isScrollOnTop=function(){return!this.hasScroll()||0===this.elem.scrollTop()},h.prototype.isScrollOnBottom=function(){return!this.hasScroll()||this.elem.scrollTop()>=this.elem[0].scrollHeight-this.elem.height()},h.prototype.active=function(e,t){return e?(this.elem.addClass("gorilla-scroller-active"),this.next()&&this.next().active(!0,!0),!t&&this.prev()&&this.prev().active(!1,!0),void s(this.index)):(this.elem.removeClass("gorilla-scroller-active"),t&&this.prev()&&this.prev().active(!1,!0),void s(this.index))},h.prototype.prev=function(){return d.find(this.index-1)},h.prototype.next=function(){return d.find(this.index+1)}}(jQuery,window.gorilla);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvcmlsbGEuc2Nyb2xsZXIuanMiXSwibmFtZXMiOlsid2luZG93IiwiZ29yaWxsYSIsIiQiLCJzZWN0aW9uc0NvbmZpZyIsInNlY3Rpb25zRG9tIiwicm9vdCIsImZpbmQiLCJlYWNoIiwiaW5kZXgiLCJzZWN0aW9ucyIsImFkZCIsInRoaXMiLCJsZW5ndGgiLCJhY3RpdmUiLCJldmVudENvbmZpZyIsInRpbWVvdXQiLCJjdXJyZW50IiwiaW5pdGlhbFNjcm9sbCIsIm1vdXNld2hlZWwiLCJjbGVhclRpbWVvdXQiLCJlbGVtIiwic2Nyb2xsVG9wIiwiZXZlbnQiLCJkZWx0YVkiLCJzZXRUaW1lb3V0IiwiaGFzU2Nyb2xsIiwic2Nyb2xsRG93biIsInNldHRpbmdzIiwic2Nyb2xsRGVsYXkiLCJzY3JvbGxVcCIsImlzU2Nyb2xsT25Cb3R0b20iLCJuZXh0IiwiaXNTY3JvbGxPblRvcCIsInByZXYiLCJuYXZpZ2F0aW9uQ29uZmlnIiwibmF2aWdhdGlvbiIsInVsIiwiZm9yRWFjaCIsIml0ZW0iLCJsaSIsImEiLCJhdHRyIiwic2VjdGlvbiIsImFwcGVuZCIsImNzcyIsInotaW5kZXgiLCJ6SW5kZXgiLCJvbiIsImhlaWdodCIsIm5hdmlnYXRpb25DaGFuZ2UiLCJyZW1vdmVDbGFzcyIsInBhcmVudHMiLCJhZGRDbGFzcyIsInNjcm9sbGVyIiwiY29uZmlnIiwiaW5pdCIsImZuIiwiZ29yaWxsYVNjcm9sbGVyIiwidG90YWxTZWN0aW9ucyIsInB1c2giLCJTZWN0aW9uIiwiZmlsdGVyIiwiaXMiLCJmaXJzdCIsImRvbSIsInNpemUiLCJwcm90b3R5cGUiLCJleHRlbmQiLCJzY3JvbGxIZWlnaHQiLCJpc0Nhc2NhZGUiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJBQUFLQSxPQUFPQyxVQUNSRCxPQUFPQyxZQUdYLFNBQVdDLEVBQUdELEdBaUVWLFFBQVNFLEtBQ0wsR0FBSUMsR0FBY0MsRUFBS0MsS0FBSyxZQUM1QkYsR0FBWUcsS0FBSyxTQUFVQyxHQUN2QkMs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QVVuQyxLQUFPLFdBQ3JCLE1BQU90QixHQUFTSCxLQUFLSyxLQUFLSCxNQUFRLEtBSXZDOEQsT0FBUXRFLE9BQU9DIiwiZmlsZSI6ImdvcmlsbGEuc2Nyb2xsZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaWYgKCF3aW5kb3cuZ29yaWxsYSkge1xyXG4gICAgd2luZG93LmdvcmlsbGEgPSB7fTtcclxufVxyXG5cclxuKGZ1bmN0aW9uICgkLCBnb3JpbGxhKSB7XHJcblxyXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gICAgICogVkFSU1xyXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgIHZhciByb290O1xyXG4gICAgdmFyIG5hdmlnYXRpb247XHJcbiAgICB2YXIgc2V0dGluZ3MgPSB7XHJcbiAgICAgICAgekluZGV4OiAwLFxyXG4gICAgICAgIHNjcm9sbERlbGF5OiAzMDBcclxuICAgIH07XHJcblxyXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gICAgICogRVhQT1JUXHJcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgZ29yaWxsYS5zY3JvbGxlciA9IGZ1bmN0aW9uIChlbGVtLCBjb25maWcpIHtcclxuICAgICAgICB0aGlzLmluaXQoJChlbGVtKSwgY29uZmlnIHx8IHt9KTtcclxuICAgIH07XHJcblxyXG4gICAgJC5mbi5nb3JpbGxhU2Nyb2xsZXIgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBnb3JpbGxhLnNjcm9sbGVyKHRoaXMsIGNvbmZpZyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAgICAqIFNFQ1RJT05TXHJcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgdmFyIHNlY3Rpb25zID0gW107XHJcblxyXG4gICAgc2VjdGlvbnMuYWRkID0gZnVuY3Rpb24gKGVsZW0sIGluZGV4LCB0b3RhbFNlY3Rpb25zKSB7XHJcbiAgICAgICAgc2VjdGlvbnMucHVzaChuZXcgU2VjdGlvbihlbGVtLCBpbmRleCwgdG90YWxTZWN0aW9ucyAtIGluZGV4ICsgc2V0dGluZ3MuekluZGV4KSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHNlY3Rpb25zLmN1cnJlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHNlY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5pcyhyb290LmZpbmQoJy5nb3JpbGxhLXNjcm9sbGVyLWFjdGl2ZScpLmZpcnN0KCkpO1xyXG4gICAgICAgIH0pWzBdO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZWN0aW9ucy5maW5kID0gZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgdmFyIGRvbSA9IHJvb3QuZmluZCgnI2dvcmlsbGEtc2Nyb2xsZXItc2VjdGlvbi0nICsgaW5kZXgpO1xyXG5cclxuICAgICAgICBpZiAoIWRvbS5zaXplKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc2VjdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmlzKGRvbSk7XHJcbiAgICAgICAgfSlbMF07XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAgICAqIE1FVEhPRFNcclxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICBnb3JpbGxhLnNjcm9sbGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGVsZW0sIGNvbmZpZykge1xyXG4gICAgICAgIHJvb3QgPSBlbGVtO1xyXG4gICAgICAgICQuZXh0ZW5kKHNldHRpbmdzLCBjb25maWcpO1xyXG5cclxuICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ2dvcmlsbGEtc2Nyb2xsZXInKTtcclxuICAgICAgICByb290LmFkZENsYXNzKCdnb3JpbGxhLXNjcm9sbGVyLXJvb3QnKTtcclxuXHJcbiAgICAgICAgc2VjdGlvbnNDb25maWcoKTtcclxuICAgICAgICBldmVudENvbmZpZygpO1xyXG4gICAgICAgIG5hdmlnYXRpb25Db25maWcocm9vdCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHNlY3Rpb25zQ29uZmlnKCkge1xyXG4gICAgICAgIHZhciBzZWN0aW9uc0RvbSA9IHJvb3QuZmluZCgnPiBzZWN0aW9uJyk7XHJcbiAgICAgICAgc2VjdGlvbnNEb20uZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcclxuICAgICAgICAgICAgc2VjdGlvbnMuYWRkKCQodGhpcyksIGluZGV4LCBzZWN0aW9uc0RvbS5sZW5ndGgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZWN0aW9uc1swXS5hY3RpdmUodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZXZlbnRDb25maWcoKSB7XHJcbiAgICAgICAgdmFyIHRpbWVvdXQ7XHJcblxyXG4gICAgICAgIHZhciBjdXJyZW50O1xyXG4gICAgICAgIHZhciBpbml0aWFsU2Nyb2xsID0gbnVsbDtcclxuICAgICAgICAkKHdpbmRvdykubW91c2V3aGVlbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcclxuICAgICAgICAgICAgY3VycmVudCA9IHNlY3Rpb25zLmN1cnJlbnQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpbml0aWFsU2Nyb2xsID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsU2Nyb2xsID0gY3VycmVudC5lbGVtLnNjcm9sbFRvcCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnQuZGVsdGFZID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudC5oYXNTY3JvbGwoKSB8fCBpbml0aWFsU2Nyb2xsID09PSBjdXJyZW50LmVsZW0uc2Nyb2xsVG9wKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsRG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdGlhbFNjcm9sbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9LCBzZXR0aW5ncy5zY3JvbGxEZWxheSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudC5oYXNTY3JvbGwoKSB8fCBpbml0aWFsU2Nyb2xsID09PSBjdXJyZW50LmVsZW0uc2Nyb2xsVG9wKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxVcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGluaXRpYWxTY3JvbGwgPSBudWxsO1xyXG4gICAgICAgICAgICB9LCBzZXR0aW5ncy5zY3JvbGxEZWxheSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIHNjcm9sbERvd24oKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBzZWN0aW9ucy5jdXJyZW50KCk7XHJcblxyXG4gICAgICAgIGlmICghY3VycmVudC5pc1Njcm9sbE9uQm90dG9tKCkgfHwgIWN1cnJlbnQubmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGN1cnJlbnQuYWN0aXZlKGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzY3JvbGxVcCgpIHtcclxuICAgICAgICB2YXIgY3VycmVudCA9IHNlY3Rpb25zLmN1cnJlbnQoKTtcclxuXHJcbiAgICAgICAgaWYgKCFjdXJyZW50LmlzU2Nyb2xsT25Ub3AoKSB8fCAhY3VycmVudC5wcmV2KCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY3VycmVudC5wcmV2KCkuYWN0aXZlKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5hdmlnYXRpb25Db25maWcoKSB7XHJcbiAgICAgICAgbmF2aWdhdGlvbiA9ICQoXCI8bmF2IGNsYXNzPSdnb3JpbGxhLXNjcm9sbGVyLW5hdmlnYXRpb24nIC8+XCIpO1xyXG4gICAgICAgIHZhciB1bCA9ICQoXCI8dWwgLz5cIik7XHJcblxyXG4gICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIGxpID0gJChcIjxsaSAvPlwiKTtcclxuICAgICAgICAgICAgdmFyIGEgPSAkKFwiPGEgLz5cIik7XHJcblxyXG4gICAgICAgICAgICBhLmF0dHIoeyBzZWN0aW9uOiBpdGVtLmluZGV4IH0pO1xyXG5cclxuXHJcbiAgICAgICAgICAgIGxpLmFwcGVuZChhKTtcclxuICAgICAgICAgICAgdWwuYXBwZW5kKGxpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbmF2aWdhdGlvbi5jc3MoeyAnei1pbmRleCc6IHNlY3Rpb25zLmxlbmd0aCArIHNldHRpbmdzLnpJbmRleCB9KTtcclxuICAgICAgICBuYXZpZ2F0aW9uLmFwcGVuZCh1bCk7XHJcbiAgICAgICAgcm9vdC5hcHBlbmQobmF2aWdhdGlvbik7XHJcblxyXG4gICAgICAgIG5hdmlnYXRpb24ub24oJ2NsaWNrJywgJ2EnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlY3Rpb25zLmZpbmQoJCh0aGlzKS5hdHRyKCdzZWN0aW9uJykpLmFjdGl2ZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG5hdmlnYXRpb24uaGVpZ2h0KHVsLmhlaWdodCgpKTtcclxuICAgICAgICAgICAgbmF2aWdhdGlvbkNoYW5nZSgpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5hdmlnYXRpb25DaGFuZ2UoKSB7XHJcbiAgICAgICAgaWYgKCFuYXZpZ2F0aW9uKSByZXR1cm47XHJcblxyXG4gICAgICAgIHZhciBjdXJyZW50ID0gc2VjdGlvbnMuY3VycmVudCgpO1xyXG5cclxuICAgICAgICBuYXZpZ2F0aW9uLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIG5hdmlnYXRpb24uZmluZCgnW3NlY3Rpb249JyArIGN1cnJlbnQuaW5kZXggKyAnXScpLnBhcmVudHMoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAgICAgKiBTRUNUSU9OU1xyXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgIHZhciBTZWN0aW9uID0gZnVuY3Rpb24gKGVsZW0sIGluZGV4LCB6SW5kZXgpIHtcclxuICAgICAgICB0aGlzLmVsZW0gPSBlbGVtO1xyXG4gICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcclxuXHJcbiAgICAgICAgZWxlbS5hZGRDbGFzcygnZ29yaWxsYS1zY3JvbGxlci1zZWN0aW9uIGdvcmlsbGEtc2Nyb2xsZXItc2VjdGlvbi0nICsgaW5kZXgpO1xyXG4gICAgICAgIGVsZW0uYXR0cignaWQnLCAnZ29yaWxsYS1zY3JvbGxlci1zZWN0aW9uLScgKyBpbmRleCk7XHJcbiAgICAgICAgZWxlbS5jc3MoeyAnei1pbmRleCc6IHpJbmRleCB9KTtcclxuICAgIH07XHJcblxyXG4gICAgU2VjdGlvbi5wcm90b3R5cGUuaXMgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1bMF0gPT09ICQoZWxlbSlbMF07XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICBTZWN0aW9uLnByb3RvdHlwZS5oYXNTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmVsZW1bMF0uc2Nyb2xsSGVpZ2h0IC0gdGhpcy5lbGVtLmhlaWdodCgpKSA+IDA7XHJcbiAgICB9O1xyXG5cclxuICAgIFNlY3Rpb24ucHJvdG90eXBlLmlzU2Nyb2xsT25Ub3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmhhc1Njcm9sbCgpIHx8IHRoaXMuZWxlbS5zY3JvbGxUb3AoKSA9PT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgU2VjdGlvbi5wcm90b3R5cGUuaXNTY3JvbGxPbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuaGFzU2Nyb2xsKCkgfHwgdGhpcy5lbGVtLnNjcm9sbFRvcCgpID49ICh0aGlzLmVsZW1bMF0uc2Nyb2xsSGVpZ2h0IC0gdGhpcy5lbGVtLmhlaWdodCgpKTtcclxuICAgIH07XHJcblxyXG4gICAgU2VjdGlvbi5wcm90b3R5cGUuYWN0aXZlID0gZnVuY3Rpb24gKGFjdGl2ZSwgaXNDYXNjYWRlKSB7XHJcbiAgICAgICAgaWYgKGFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW0uYWRkQ2xhc3MoJ2dvcmlsbGEtc2Nyb2xsZXItYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5uZXh0KCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmV4dCgpLmFjdGl2ZSh0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFpc0Nhc2NhZGUgJiYgdGhpcy5wcmV2KCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldigpLmFjdGl2ZShmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5hdmlnYXRpb25DaGFuZ2UodGhpcy5pbmRleCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZWxlbS5yZW1vdmVDbGFzcygnZ29yaWxsYS1zY3JvbGxlci1hY3RpdmUnKTtcclxuICAgICAgICBpZiAoaXNDYXNjYWRlICYmIHRoaXMucHJldigpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldigpLmFjdGl2ZShmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBuYXZpZ2F0aW9uQ2hhbmdlKHRoaXMuaW5kZXgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBTZWN0aW9uLnByb3RvdHlwZS5wcmV2ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBzZWN0aW9ucy5maW5kKHRoaXMuaW5kZXggLSAxKTtcclxuICAgIH07XHJcblxyXG4gICAgU2VjdGlvbi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gc2VjdGlvbnMuZmluZCh0aGlzLmluZGV4ICsgMSk7XHJcbiAgICB9O1xyXG5cclxuXHJcbn0pKGpRdWVyeSwgd2luZG93LmdvcmlsbGEpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
